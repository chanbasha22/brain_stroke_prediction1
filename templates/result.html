<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Prediction Result</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

  <div class="container mt-5">
    <div class="card p-5 shadow text-center">
      <h2>ğŸ” Prediction Result</h2>
      <h3 class="mt-3">Stroke Risk: 
        <span class="text-{{ 'danger' if prediction == 'Yes' else 'success' }}">
          {{ prediction }}
        </span>
      </h3>
      <p class="lead">Estimated Probability: <strong>{{ probability }}%</strong></p>
      <a href="{{ url_for('home') }}" class="btn btn-outline-primary mt-3">Try Again</a>
    </div>

    {% if prediction == 'Yes' %}
    <div class="row mt-5 g-4">
      <div class="col-md-4">
        <div class="card shadow-sm p-3">
          <h5>ğŸ©º Consult Doctor</h5>
          <a href="https://www.practo.com/consult" target="_blank" class="btn btn-outline-dark w-100 mt-2">Consult Now</a>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card shadow-sm p-3">
          <h5>ğŸ“… Book Appointment</h5>
          <a href="{{ url_for('book_appointment') }}" class="btn btn-outline-success w-100 mt-2">Book Now</a>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card shadow-sm p-3">
          <h5>ğŸ¥— Health Suggestions</h5>
          <ul class="text-start">
            <li>Eat fruits & vegetables</li>
            <li>Exercise regularly</li>
            <li>Sleep 7â€“8 hrs daily</li>
            <li>Avoid smoking/alcohol</li>
          </ul>
        </div>
      </div>
    </div>
    {% else %}
    <div class="card mt-5 shadow text-center p-4 bg-success text-white">
      <h4>âœ… You're not at immediate risk!</h4>
      <p class="mb-0">Thanks for using Brain Stroke Predictor.</p>
    </div>
    {% endif %}
  </div>
<!-- Chatbot Widget -->
<div id="chatbot" style="position: fixed; bottom: 20px; right: 20px; z-index: 9999;">
  <button id="chatToggle" class="btn btn-primary rounded-circle" style="width: 50px; height: 50px; font-size: 20px;">
    ğŸ’¬
  </button>
  <div id="chatWindow" class="card shadow p-3" style="display: none; width: 250px; height: 300px; overflow-y: auto; position: absolute; bottom: 60px; right: 0;">
    <div style="font-weight: bold; margin-bottom: 8px;">ğŸ§  Health Assistant</div>
    <div id="chatMessages" style="height: 180px; overflow-y: auto; font-size: 13px;"></div>
    <div class="input-group mt-2">
      <input type="text" id="chatInput" class="form-control form-control-sm" placeholder="Ask...">
      <button class="btn btn-sm btn-outline-secondary" onclick="sendChat()">Send</button>
    </div>
  </div>
</div>

<script>
const chatToggle = document.getElementById("chatToggle");
const chatWindow = document.getElementById("chatWindow");
const chatInput = document.getElementById("chatInput");
const chatMessages = document.getElementById("chatMessages");

chatToggle.addEventListener("click", () => {
  chatWindow.style.display = chatWindow.style.display === "none" ? "block" : "none";
});

function sendChat() {
  const userMessage = chatInput.value.trim();
  if (!userMessage) return;

  addChatMessage("You", userMessage);
  chatInput.value = "";

  let response = "ğŸ¤– I'm here to help with appointments, doctors, hours, insurance, and emergencies. Ask me anything!";
  const msg = userMessage.toLowerCase();

  if (["gm", "good morning"].includes(msg)) {
    response = "ğŸŒ Good Morning! How can I assist you today?";
  } else if (["gn", "good night"].includes(msg)) {
    response = "ğŸŒ™ Good night! Take care and rest well.";
  } else if (msg.includes("hi") || msg.includes("hello") || msg.includes("hai")) {
    response = "Welcome to Prediction App Assistant ğŸ‘¨â€âš•ï¸ How can I assist you today?";
  } else if (["yes", "yeah", "yup", "ya", "sure", "of course"].includes(msg)) {
    response = "Great! ğŸ‘ Let me know the details or what you'd like to proceed with.";
  } else if (["no", "nope", "nah", "not now"].includes(msg)) {
    response = "No problem ğŸ˜Š Let me know whenever you're ready.";
  } else if (msg.includes("appointment")) {
    response = "Sure, do you want to book an appointment with a General Physician, Dentist, or Pediatrician?";
  } else if (msg.includes("general") || msg.includes("physician")) {
    response = "Dr. Anil Kumar (General Physician) is available from 10 AM to 1 PM. Would you like to book a slot?";
  } else if (msg.includes("dentist")) {
    response = "Dr. Rekha Sharma (Dentist) is available from 2 PM to 5 PM. Would you like to book an appointment?";
  } else if (msg.includes("pediatrician")) {
    response = "Dr. Neha Joshi (Pediatrician) is available from 9 AM to 12 PM. Shall I book your visit?";
  } else if (msg.includes("cardiologist")) {
    response = "Dr. Ramesh Varma (Cardiologist) is available on Mon, Wed, Fri from 10 AM to 12 PM.";
  } else if (msg.includes("orthopedic") || msg.includes("bone doctor")) {
    response = "Dr. Sudheer Reddy (Orthopedic Surgeon) is available on Tue, Thu, Sat from 11 AM to 1 PM.";
  } else if (msg.includes("ambulance")) {
    response = "Yes, we provide 24x7 ambulance services. Call ğŸ“ 1800-123-456 for immediate help.";
  } else if (msg.includes("emergency")) {
    response = "For emergencies, please call our 24x7 helpline: ğŸ“ 1800-123-456 or rush to the ER immediately!";
  } else if (msg.includes("services")) {
    response = "We offer General Medicine, Dental, Pediatrics, Cardiology, Orthopedics, Lab Tests, Vaccination, and more.";
  } else if (msg.includes("vaccine")) {
    response = "Yes, we offer COVID-19, Hepatitis, Typhoid, and Flu vaccines for all age groups.";
  } else if (msg.includes("insurance")) {
    response = "Yes, we accept major health insurances like Star Health, Niva Bupa, ICICI Lombard, and others.";
  } else if (msg.includes("blood test") || msg.includes("lab")) {
    response = "Yes, we have a full lab testing facility open from 8 AM to 6 PM. No appointment needed.";
  } else if (msg.includes("opd") || msg.includes("outpatient")) {
    response = "OPD timings are 8 AM to 8 PM, Monday to Saturday.";
  } else if (msg.includes("hours") || msg.includes("timing") || msg.includes("open")) {
    response = "City Hospital is open Monday to Saturday from 8 AM to 8 PM. Emergency service: 24/7.";
  } else if (msg.includes("location") || msg.includes("address")) {
    response = "Predication Creators is located at ğŸ“ Vasavi College, Tadepalligudem.";
  } else if (msg.includes("date")) {
    const today = new Date();
    response = `ğŸ“… Today's date is ${today.toDateString()}.`;
  } else if (msg.includes("time")) {
    const now = new Date();
    response = `ğŸ•’ The current time is ${now.toLocaleTimeString()}.`;
  } else if (msg.includes("bmi") || msg.includes("body mass index")) {
    response = "ğŸ§® A healthy BMI is between 18.5 and 24.9.";
  } else if (msg.includes("glucose") || msg.includes("sugar level")) {
    response = "ğŸ©¸ Normal blood glucose level (fasting) is between 70â€“99 mg/dL.";
  } else if (msg.includes("heartbeat") || msg.includes("heart rate")) {
    response = "â¤ï¸ Normal heart rate is 60â€“100 bpm at rest.";
  } else if (msg.includes("pulse")) {
    response = "ğŸ’“ Pulse is the same as heart rate and can be felt on your wrist or neck.";
  } else if (msg.includes("blood pressure") || msg.includes("bp")) {
    response = "ğŸ”´ Normal BP is around 120/80 mmHg.";
  } else if (msg.includes("oxygen") || msg.includes("spo2")) {
    response = "ğŸ« SpO2 levels should be between 95% and 100%.";
  } else if (msg.includes("fever") || msg.includes("temperature")) {
    response = "ğŸŒ¡ï¸ Fever is body temp above 100.4Â°F (38Â°C).";
  } else if (["ok", "okay", "fine", "cool", "nice", "great", "good", "hmm"].includes(msg)) {
    response = "Alright! Let me know if you have any more questions. ğŸ˜Š";
  } else if (msg.includes("thank")) {
    response = "You're most welcome! ğŸ™ Stay safe and healthy.";
  } else if (msg.includes("bye")) {
    response = "Goodbye! ğŸ‘‹ Wishing you good health. Come back if you need anything.";
  }

  setTimeout(() => addChatMessage("Bot", response), 500);
}

function addChatMessage(sender, message) {
  const div = document.createElement("div");
  div.innerHTML = `<strong>${sender}:</strong> ${message}`;
  chatMessages.appendChild(div);
  chatMessages.scrollTop = chatMessages.scrollHeight;
}
</script>



</body>
</html>
